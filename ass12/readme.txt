all implementations and explanations are in the comments
I had a problem with the second problem but I hope the idea is good to get some points
Also check for theoretical parts of the homework in the comments 
